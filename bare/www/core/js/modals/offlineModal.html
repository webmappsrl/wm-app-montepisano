<ion-modal-view>
    <ion-header-bar class="bar-stable">
        <a class="modal-close-header" ng-if="!downloadInProgress && !unzipInProgress" ng-click="hide()">
            <i class="icon wm-icon-android-close"></i>
        </a>
        <h1 class="title">
            <span class="title-inner-header">
                {{"MAPPA OFFLINE" | translate}}
            </span>
        </h1>
    </ion-header-bar>

    <ion-content class="offline-page">
        <div class="static-content offline-content">

            <!-- <div class="offline-image">
                <img src="/core/images/logo-big.png">
            </div> -->

            <div class="static-description offline-description">
                <h2 class="offline-desc-title" ng-if="canBeEnabled && !downloadInProgress && !unzipInProgress && !installationInProgress">
                    {{"Scarica la mappa" | translate}}</h2>
                <p class="offline-desc-text" ng-if="!active && canBeEnabled">
                    {{"Abilita la funzione di navigazione offline" | translate}}</p>
                <p class="offline-desc-text" ng-if="!active && !canBeEnabled">
                    {{"Durante la modalità offline tutti i dati visualizzati potrebbero non essere aggiornati" | translate}}</p>
                <p class="offline-desc-text" ng-if="active && canBeEnabled">
                    {{"Disabilita la funzione di navigazione offline" | translate}}</p>

                <p ng-if="!canBeEnabled && !downloadInProgress && !unzipInProgress && !installationInProgress">
                    {{message}}
                </p>
            </div>

            <div style="color: black;" ng-if="downloadInProgress || installationInProgress">
                <p class="offline-text offline-download">
                    {{"Download in corso" | translate}}
                </p>
                <div class="offline-progress-bar" ng-style="
                    downloadProgress !== 100 ? {
                        'background': 'linear-gradient(to right, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + downloadProgress + '%, #FFFFFF ' + downloadProgress + '%, #FFFFFF 100%)',
                        'background': '-moz-linear-gradient(left, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + downloadProgress + '%, #FFFFFF ' + downloadProgress + '%, #FFFFFF 100%)',
                        'background': '-webkit-linear-gradient(left, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + downloadProgress + '%, #FFFFFF ' + downloadProgress + '%, #FFFFFF 100%)'
                    } : {
                        'background': '#33CC33'
                    }
                    ">
                </div>
                <p class="offline-text offline-install">
                    {{downloadProgress}}%
                </p>
                <div class="button-reset button button-block" ng-click="abortMapDownload()" ng-if="downloadInProgress">
                    {{"Interrompi" | translate}}
                </div>

                <p ng-if="installationInProgress" class="offline-text offline-download">
                    {{"Installazione in corso" | translate}}
                </p>
                <div ng-if="installationInProgress" class="offline-progress-bar" ng-style="
                    installationProgress !== 100 ? {
                        'background': 'linear-gradient(to right, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + installationProgress + '%, #FFFFFF ' + installationProgress + '%, #FFFFFF 100%)',
                        'background': '-moz-linear-gradient(left, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + installationProgress + '%, #FFFFFF ' + installationProgress + '%, #FFFFFF 100%)',
                        'background': '-webkit-linear-gradient(left, ' + COLORS.global.buttonsBackground + ' 0%, ' + COLORS.global.buttonsBackground + ' ' + installationProgress + '%, #FFFFFF ' + installationProgress + '%, #FFFFFF 100%)'
                    } : {
                        'background': '#33CC33'
                    }
                    ">
                </div>
                <p ng-if="installationInProgress" class="offline-text offline-install">
                    {{installationProgress}}%
                </p>
            </div>
            <button ng-style="{
                    'background': COLORS.global.buttonsBackground,
                    'color': COLORS.global.buttonsColor
                    }" class="button-download button button-block" ng-if="!canBeEnabled && !downloadInProgress && !unzipInProgress && !installationInProgress" ng-click="downloadMap()">
                <span>
                    <i class="icon wm-icon-ios7-download-outline"></i> {{"Download" | translate}}
                </span>
            </button>

            <!-- TODO: add classes for button -->
            <button ng-style="{
                    'background': COLORS.global.buttonsBackground,
                    'color': COLORS.global.buttonsColor
                }" class="button-download button button-block" ng-click="toggleMode()" ng-if="canBeEnabled">
                <span ng-if="active">{{"Disabilita modalità offline" | translate}}</span>
                <span ng-if="!active">{{"Abilita modalità offline" | translate}}</span>
            </button>

            <!-- TODO:replace with style -->
            <br />

            <div ng-if="!downloadInProgress && !unzipInProgress && !installationInProgress && (canBeEnabled || hasChunkDownloaded)">
                <span>
                    {{"Premi il tasto Reset per cancellare l'attuale versione della mappa e procedere successivamente al download della nuova versione" | translate}}
                </span>

                <br />
                <br />

                <!-- TODO: add classes for button -->
                <button class="button button-block button-reset" ng-click="reset()" ng-if="!downloadInProgress && !unzipInProgress && (canBeEnabled || hasChunkDownloaded)">
                    <span>{{"Reset" | translate}}</span>
                </button>
            </div>
        </div>
    </ion-content>

    <!-- TODO: make it visible -->
    <!-- <div class="bottom-buttons">
        <button
            class="button button-small"
            ng-click="hide()">
            chiudi
        </button>
    </div> -->
</ion-modal-view>
