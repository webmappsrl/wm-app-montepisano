<ion-modal-view class="modal-mappalo modal-filters">
    <a class="modal-close" ng-click="vm.hide()">
        <i class="icon wm-icon-android-close"></i>
    </a>
    <ion-content ng-style="{
        'background': vm.COLORS.details.background
    }">
        <div class="modal-content">
            <span class="modal-title">{{"VISUALIZZA/NASCONDI CATEGORIE" | translate}}</span>

            <!-- <ion-list>
                <label 
                    class="item item-checkbox ng-not-empty" 
                    ng-repeat="(key, obj) in vm.filters" 
                    ng-init="currentFilter = obj.value" 
                    ng-model="obj.value" 
                    ng-class="{
                        'is-selected': obj.value,
                        'is-not-selected': !obj.value
                    }">
                    <div class="checkbox checkbox-input-hidden disable-pointer-events checkbox-circle">
                        <input 
                            type="checkbox" 
                            ng-model="obj.value" 
                            ng-change="vm.updateFilter(key, obj.value)" 
                            class="ng-untouched ng-valid ng-dirty ng-valid-parse ng-not-empty">
                            <i 
                                class="ion-android-checkbox-outline"
                                ng-class="{
                                    'ion-android-checkbox-outline': obj.value,
                                    'ion-android-checkbox-outline-blank': !obj.value
                                }"></i>
                    </div>
                    <div 
                        class="item-content disable-pointer-events">
                        <span ng-if="key !== 'Tutte'">{{obj.name}}</span>
                        <strong ng-if="key === 'Tutte'">{{obj.name}}</strong>
                        <span ng-if="obj.icon !== 'wm-icon-generic'"
                            class="icon {{obj.icon}}"
                            style="float: right"
                            ng-style="{ 'color': obj.color }"></span>
                    </div>
                </label>
            </ion-list>

            <br><br>
            <span class="modal-title" ng-if="vm.isMap">{{"CAMBIA MAPPA DI BASE" | translate}}</span>

            <ion-list 
                class="round-list"
                ng-if="vm.isMap">
                <label 
                    class="item item-checkbox ng-not-empty is-not-selected" 
                    ng-repeat="(key, value) in vm.baseLayers"
                    >
                    <div class="checkbox checkbox-input-hidden disable-pointer-events checkbox-circle">
                        <input 
                            type="checkbox" 
                            ng-model="currentFilter"
                            ng-change="vm.updateBaseMap(key)" 
                            class="ng-untouched ng-valid ng-dirty ng-valid-parse ng-not-empty">
                            <i 
                                class="wm-icon-ion-android-checkmark-circle-empty"
                                ng-class="{
                                    'wm-icon-ion-android-checkmark-circle': vm.currentMapLayer == key,
                                    'wm-icon-ion-android-checkmark-circle-empty': vm.currentMapLayer != key
                                }"></i>
                    </div>
                    <div 
                        class="item-content disable-pointer-events">
                        <span>{{key}}</span>
                    </div>
                </label>
            </ion-list> -->

            <div class="accordion-filters">
                <div class="filters-tab-title-container">
                    <div ng-repeat="(key, item) in filters.items" ng-click="switchTab(key)" class="filters-tab-title" ng-class="{
                            'selected': filters.selected === key
                        }">
                        {{item.name}}
                    </div>
                </div>
                <div class="filters-tab-content-container">
                    <div ng-repeat="(key, item) in filters.items" class="filters-tab-content" ng-class="{
                        'selected': filters.selected === key
                    }">
                        <div ng-repeat="(sublayerId, sublayer) in item.sublayers" class="filters-sublayer">
                            <div>
                                <i class="left-icon" ng-class="{
                                    'ion-android-checkbox-outline': layer.selected,
                                    'ion-android-checkbox-outline-blank': !layer.selected
                                }"></i>
                                <div  ng-click="toggleSublayer(sublayerId, key)">
                                    {{sublayer.name}}
                                    <i ng-if="sublayerId !== item.open" class="icon wm-icon-ios7-arrow-forward right-icon"></i>
                                    <i ng-if="sublayerId === item.open" class="icon wm-icon-ios7-arrow-down right-icon"></i>
                                </div>
                            </div>

                            <div class="filters-layer" ng-repeat="(layerId, layer) in sublayer.items" ng-class="{
                                    'animate-show': item.open === sublayerId,
                                    'animate-hide': item.open !== sublayerId
                                }" ng-click="toggleLayer(layerId, sublayerId, key)">
                                <i class="left-icon" ng-if="sublayerId === item.open" ng-class="{
                                    'ion-android-checkbox-outline': layer.selected,
                                    'ion-android-checkbox-outline-blank': !layer.selected
                                }"></i>
                                {{layer.name}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ion-content>
</ion-modal-view>